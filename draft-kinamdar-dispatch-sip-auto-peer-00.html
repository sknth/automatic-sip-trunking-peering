<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Automatic Peering for SIP Trunks</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions and Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Reference Architecture">
<link href="#rfc.section.4" rel="Chapter" title="4 Configuration Workflow">
<link href="#rfc.section.5" rel="Chapter" title="5 Overview of Operations">
<link href="#rfc.section.6" rel="Chapter" title="6 HTTP Transport">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 HTTP Methods">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Integrity and Confidentiality">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Authenticated Client Identity">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 Encoding the Request">
<link href="#rfc.section.6.5" rel="Chapter" title="6.5 Generating the Response">
<link href="#rfc.section.6.6" rel="Chapter" title="6.6 Identifying the Request Target">
<link href="#rfc.section.7" rel="Chapter" title="7 State Deltas">
<link href="#rfc.section.8" rel="Chapter" title="8 Encoding the Service Provider Capability Set">
<link href="#rfc.section.9" rel="Chapter" title="9 Data Model for Capability Set">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Tree Diagram">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 YANG Model">
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 Node Definitions">
<link href="#rfc.section.9.4" rel="Chapter" title="9.4 Extending the Capability Set">
<link href="#rfc.section.10" rel="Chapter" title="10 Example Capability Set Document Encoding">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 JSON Capability Set Document">
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 XML Capability Set Document">
<link href="#rfc.section.11" rel="Chapter" title="11 Example Exchange">
<link href="#rfc.section.12" rel="Chapter" title="12 Security Considerations">
<link href="#rfc.section.13" rel="Chapter" title="13 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="14 References">
<link href="#rfc.references.1" rel="Chapter" title="14.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="14.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.8.4 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Inamdar, K., Narayanan, S., and C. Jennings" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-kinamdar-dispatch-sip-audo-peer-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-9-10" />
  <meta name="dct.abstract" content="This draft specifies a configuration workflow to enable enterprise Session Initiation Protocol (SIP) networks to solicit the capability set of a SIP service provider network. The capability set can subsequently be used to configure features and services on the enterprise edge element, such as a Session Border Controller (SBC), to ensure smooth peering between enterprise and service provider networks.  " />
  <meta name="description" content="This draft specifies a configuration workflow to enable enterprise Session Initiation Protocol (SIP) networks to solicit the capability set of a SIP service provider network. The capability set can subsequently be used to configure features and services on the enterprise edge element, such as a Session Border Controller (SBC), to ensure smooth peering between enterprise and service provider networks.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">K. Inamdar</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">S. Narayanan</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">C. Jennings</td>
</tr>
<tr>
<td class="left">Expires: March 13, 2020</td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">September 10, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Automatic Peering for SIP Trunks<br />
  <span class="filename">draft-kinamdar-dispatch-sip-audo-peer-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This draft specifies a configuration workflow to enable enterprise Session Initiation Protocol (SIP) networks to solicit the capability set of a SIP service provider network. The capability set can subsequently be used to configure features and services on the enterprise edge element, such as a Session Border Controller (SBC), to ensure smooth peering between enterprise and service provider networks.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on March 13, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions and Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Reference Architecture</a>
</li>
<li>4.   <a href="#rfc.section.4">Configuration Workflow</a>
</li>
<li>5.   <a href="#rfc.section.5">Overview of Operations</a>
</li>
<li>6.   <a href="#rfc.section.6">HTTP Transport</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">HTTP Methods</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Integrity and Confidentiality</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">Authenticated Client Identity</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">Encoding the Request</a>
</li>
<li>6.5.   <a href="#rfc.section.6.5">Generating the Response</a>
</li>
<li>6.6.   <a href="#rfc.section.6.6">Identifying the Request Target</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">State Deltas</a>
</li>
<li>8.   <a href="#rfc.section.8">Encoding the Service Provider Capability Set</a>
</li>
<li>9.   <a href="#rfc.section.9">Data Model for Capability Set</a>
</li>
<ul><li>9.1.   <a href="#rfc.section.9.1">Tree Diagram</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">YANG Model</a>
</li>
<li>9.3.   <a href="#rfc.section.9.3">Node Definitions</a>
</li>
<li>9.4.   <a href="#rfc.section.9.4">Extending the Capability Set</a>
</li>
</ul><li>10.   <a href="#rfc.section.10">Example Capability Set Document Encoding</a>
</li>
<ul><li>10.1.   <a href="#rfc.section.10.1">JSON Capability Set Document</a>
</li>
<li>10.2.   <a href="#rfc.section.10.2">XML Capability Set Document</a>
</li>
</ul><li>11.   <a href="#rfc.section.11">Example Exchange</a>
</li>
<li>12.   <a href="#rfc.section.12">Security Considerations</a>
</li>
<li>13.   <a href="#rfc.section.13">Acknowledgments</a>
</li>
<li>14.   <a href="#rfc.references">References</a>
</li>
<ul><li>14.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>14.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The deployment of a Session Initiation Protocol (SIP)-based infrastructure in enterprise and service provider communication networks is increasing at a rapid pace. Consequently, direct IP peering between enterprise and service provider networks is quickly replacing traditional methods of interconnection between enterprise and service provider networks.  </p>
<p id="rfc.section.1.p.2">Currently published standards provide a strong foundation over which direct IP peering can be realized. However, given the sheer number of these standards, it is often not clear which behavioral subsets, extensions to baseline protocols and operating principles ought to be implemented by service provider and enterprise networks to ensure successful peering.  </p>
<p id="rfc.section.1.p.3">The SIP Connect technical recommendations aim to solve this problem by providing a master reference that promotes seamless peering between enterprise and service provider SIP networks. However, despite the extensive set of implementation rules and operating guidelines, interoperability issues between service provider and enterprise networks persist. This is in large part because service providers and equipment manufacturers aren&#8217;t required to enforce the guidelines of the technical specifications and have a fair degree of freedom to deviate from them.  Consequently, enterprise administrators usually undertake a fairly rigorous regimen of testing, analysis and troubleshooting to arrive at a configuration block that ensures seamless service provider peering.  </p>
<p id="rfc.section.1.p.4">Another set of interoperability problems arise when enterprise administrators are required to translate a set of technical recommendations from service providers to configuration blocks across one or more devices in the enterprise, which is usually an error prone exercise. Additionally, such technical recommendations might not be nuanced enough to intuitively allow the generation of specific configuration blocks.  </p>
<p id="rfc.section.1.p.5">This draft introduces a mechanism using which an enterprise network can solicit a detailed capability set from a SIP service provider; the detailed capability set can subsequently be used by automaton or an administrator to generate configuration blocks across one or more devices within the enterprise to ensure successful service provider peering.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#conventions-and-terminology" id="conventions-and-terminology">Conventions and Terminology</a>
</h1>
<p id="rfc.section.2.p.1">The The keywords &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in <a href="#RFC2119" class="xref">[RFC2119]</a> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#reference-architecture" id="reference-architecture">Reference Architecture</a>
</h1>
<p id="rfc.section.3.p.1">Figure 1 illustrates a reference architecture that may be deployed to support the mechanism described in this document. The enterprise network consists of a SIP-PBX, media endpoints and a Session Border Controller.  It may also include additional components such as application servers for voicemail, recording, fax etc. At a high level, the service provider consists of a SIP signaling entity (SP-SSE), a media entity and a HTTP(S) server.  </p>
<pre>

    +-----------------------------------------------------+
    | +---------------+         +-----------------------+ |
    | |               |         |                       | |
    | | +----------+  |         |   +-------+           | |
    | | |   Cap    |  | HTTPS   |   |       |           | |
    | | |  Server  |&lt;-|---------|--&gt;|       |           | |
    | | |          |  |         |   |       |   +-----+ | |
    | | +----------+  |         |   |       |   | SIP | | |
    | |               |         |   |       |&lt;-&gt;| PBX | | |
    | |               |         |   |       |   +-----+ | | 
    | | +----------+  |         |   |  SBC  |           | |
    | | |          |  |   SIP   |   |       |           | |
    | | | SP - SSE |&lt;-|---------|--&gt;|       |   +-----+ | |
    | | |          |  |         |   |       |&lt;-&gt;| M.E.| | |
    | | +----------+  |         |   |       |   |     | | |
    | |               |         |   |       |   +-----+ | |
    | | +----------+  |  SRTP   |   |       |           | |
    | | |  Media   |&lt;-|---------|--&gt;+-------+           | |
    | | +----------+  |         |                       | |
    | +---------------+         +-----------------------+ |    |                                                     |
    +-----------------------------------------------------+

    Figure 1: Reference Architecture

</pre>
<p id="rfc.section.3.p.2">This draft makes use of the following terminology: </p>
<p></p>

<ul>
<li>Enterprise Network: A communications network infrastructure deployed by an enterprise which interconnects with the service provider network over SIP. The enterprise network could include devices such as application servers, endpoints, call agents and edge devices among others.</li>
<li>Edge Device: A device that is the last hop in the enterprise network and that is the transit point for traffic entering and leaving the enterprise. An edge device is typically a back-to-back user agent (B2BUA) such as a Session Border Controller (SBC).</li>
<li>Service Provider Network: A communications network infrastructure deployed by service providers. In the context of this draft, the service provider network is accessible over SIP for the establishment, modification and termination of calls and accessible over HTTP(S) for the transfer of the capability set document. The service provider network is also referred to as a SIP Service Provider (SSP) or Internet Telephony Service Provider (ITSP) network. These networks typically interconnect with other service provider networks over SIP or ISDN.</li>
<li>Call Control: Call Control within a telephony networks refers to software that is responsible for delivering its core functionality. Call control not only provides the basic functionality of setting up, sustaining and terminating calls, but also provides the necessary control and logic required for additional services within the telephony network.</li>
<li>Capability Server: A server hosted in the service provider network, such that this server is the target for capability set document requests from the enterprise network.</li>
<li>Capability Set: This specification uses the term capability set (or capability set document) to refer collectively to a set of characteristics within the service provider network, which when communicated to the enterprise network allows it to obtain sufficient information required to peer successfully with the service provider network.</li>
</ul>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#configuration-workflow" id="configuration-workflow">Configuration Workflow</a>
</h1>
<p id="rfc.section.4.p.1">A workflow that facilitates an enterprise network to solicit the capability set of a SIP service provider ought to take into account the following considerations: </p>
<p></p>

<ul>
<li>The configuration workflow must be based on a protocol or a set of protocols commonly used between enterprise and service provider telephony networks.</li>
<li>The configuration workflow must be flexible enough to allow the service provider network to dynamically offload different capability sets to different enterprise networks based on the identity of the enterprise network.</li>
<li>Capability set documents obtained as a result of the configuration workflow must be conducive to easy parsing by automaton. Subsequently, automaton may be used for generation of appropriate configuration blocks.</li>
</ul>

<p> </p>
<p id="rfc.section.4.p.3">Taking the above considerations into account, this document proposes a Hypertext Transfer Protocol (HTTP)-based workflow using which the enterprise network can solicit and ultimately obtain the service provider capability set. The enterprise network creates a well formed HTTPS GET request to solicit the service provider capability set.  Subsequently, the HTTPS response from the SIP service provider includes the capability set. The capability set is encoded in either XML or JSON, thus ensuring that the response can be easily parsed by automaton.  </p>
<p id="rfc.section.4.p.4">There are alternative mechanisms using which the SIP service provider can offload its capability set. For example, the Session Initiation Protocol (SIP) can be extended to define a new event package <a href="#RFC6665" class="xref">[RFC6665]</a>, such that the enterprise network can establish a SIP subscription with the service provider for its capability set; the SIP service provider can subsequently use the SIP NOTIFY request to communicate its capability set or any state deltas to its baseline capability set. This mechanism is likely to result in a significant amount of operational complexity. For example, not only would this workflow require enterprise and service provider equipment manufacturers to upgrade their software stacks, but it would also create a significant amount of ambiguity in terms of which device in the service provider network handles subscriptions and generates notifications. Yet another example of an alternative mechanism would be for service providers and enterprise equipment manufacturers to agree on YANG models <a href="#RFC6020" class="xref">[RFC6020]</a> that enable configuration to be pushed over NETCONF <a href="#RFC6241" class="xref">[RFC6241]</a> to enterprise networks from a centralized source hosted in service provider networks.  The presence of proprietary software logic for call and media handling in enterprise devices would preclude the generation of a &#8220;one-size-fits-all&#8221; YANG model. Additionally, service provider networks pushing configuration to enterprises devices might lead to the loss of implementation autonomy on the part of the enterprise network.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#overview-of-operations" id="overview-of-operations">Overview of Operations</a>
</h1>
<p id="rfc.section.5.p.1">To solicit the capability set of the SIP service provider, the edge element in the enterprise network generates a well-formed HTTPS GET request. There are two reasons why it makes sense for the enterprise edge element to generate the HTTPs request: </p>
<p></p>

<ol><li>Edge elements are devices that normalize any mismatches between the enterprise and service provider networks in the media and signaling planes. As a result, when the capability set is received from the SIP service provider network, the edge element can generate appropriate configuration blocks (possibly across multiple devices) to enable smooth IP peering. 2. Given that edge elements are configured to &#8220;talk&#8221; to networks external to the enterprise, the complexity in terms of NAT traversal and firewall configuration would be minimal.</li></ol>

<p> </p>
<p id="rfc.section.5.p.3">The HTTPs GET request is targeted at a capability server that is managed by the SIP service provider such that this server processes, and on successfully processing the request, includes the capability set document in the response. The capability set document is constructed according the guidelines of the YANG model described in this draft. The capability set document included in a successful response is formatted in either XML or JSON. The formatting depends on the value of the &#8220;Accept&#8221; header field of the HTTP GET request. More details about the formatting of the HTTP request and response are provided in Section 6 </p>
<p id="rfc.section.5.p.4">Figure 1 provides a reference architecture in which this workflow may be implemented. The architecture depicted in Figure 1 consists of an enterprise telephony network and a SIP service provider network, such that the enterprise network attempts to provision SIP trunking services for the first time. For the sake of simplicity, the enterprise and service provider networks are decomposed into their core constituent elements.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#http-transport" id="http-transport">HTTP Transport</a>
</h1>
<p id="rfc.section.6.p.1">This section describes the use of HTTP as a transport protocol for the peering workflow. This workflow is based on HTTP version 1.1 </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#http-methods" id="http-methods">HTTP Methods</a>
</h1>
<p id="rfc.section.6.1.p.1">The workflow defined in this document leverages the HTTP GET method and its corresponding response(s) to request for and subsequently obtain the service provider capability set document. The HTTP POST method and its corresponding response(s) is also used for client authentication.  </p>
<p id="rfc.section.6.1.p.2">To ensure the smooth operation of this workflow, this draft enforces certain controls (not to be confused with HTTP controls as defined in <a href="#RFC7231" class="xref">[RFC7231]</a> on the HTTP client and server. These controls as they relate to formatting, operational guidelines, security concerns and more, are detailed in subsequent sections of this draft.  </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#integrity-and-confidentiality" id="integrity-and-confidentiality">Integrity and Confidentiality</a>
</h1>
<p id="rfc.section.6.2.p.1">Peering requests and responses are defined over HTTP. However, due to the sensitive nature of information transmitted between client and server, it is required to secure HTTP using Transport Layer Security.  The enterprise edge element and capability server MUST be compliant to <a href="#RFC7235" class="xref">[RFC7235]</a>. The enterprise edge element and capability server MUST support the use of the https uri scheme as defined in <a href="#RFC7230" class="xref">[RFC7230]</a>.  </p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> <a href="#authenticated-client-identity" id="authenticated-client-identity">Authenticated Client Identity</a>
</h1>
<p id="rfc.section.6.3.p.1">The configuration workflow and corresponding YANG model described in this draft allow for smooth IP peering between enterprise and SIP service provider networks by encoding the essential session and media characteristics. It is NOT RECOMMENDED to encode information that is sensitive in nature. It is only required for the client (enterprise edge element) to authenticate the SIP service provider. If however, there is a need for the SIP service provider to authenticate the enterprise edge element, client authentication mechanisms based on OAuth 2.0 token are RECOMMENDED. The specifics of how the client obtains such tokens is outside the scope of this draft. Section 11 provides an example of how clients may be authenticated using OAuth 2.0 tokens.  </p>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> <a href="#encoding-the-request" id="encoding-the-request">Encoding the Request</a>
</h1>
<p id="rfc.section.6.4.p.1">The edge element in the enterprise network generates a HTTPS GET request such that the request-target is obtained using the procedure outlined in section 6.6 The MIME types for the capability set document defined in this draft are &#8220;application/peering-info+json&#8221; and &#8220;application/peering-info+xml&#8221;. Accordingly, the Accept header field value MUST be restricted only to these MIME types. It is possible that the edge element supports responses formatted in both JSON and XML. In such situations, the edge element might generate a HTTPS GET request such that the Accept header field includes both MIME types along with the corresponding &#8220;qvalue&#8221; for each MIME type. For implementations that require client authentication, the bearer access token acquired by the client (see section 6.3) MUST be presented to the capability server to the obtain the capability set document. The bearer token is presented in the &#8220;Authorization&#8221; header field of the GET request as specified in Section 2.1 of <a href="#RFC6750" class="xref">[RFC6750]</a>.  </p>
<p id="rfc.section.6.4.p.2">The generated HTTPS GET request MUST NOT use the &#8220;Expect&#8221; and &#8220;Range&#8221; header fields. The requests also MUST NOT use any conditional request.  </p>
<h1 id="rfc.section.6.5">
<a href="#rfc.section.6.5">6.5.</a> <a href="#generating-the-response" id="generating-the-response">Generating the Response</a>
</h1>
<p id="rfc.section.6.5.p.1">Capability servers include the capability set documents in the body of a successful response. Capability set documents MUST be formatted in XML or JSON. For requests that are incorrectly formatted, the capability server SHOULD generate a &#8220;400 Bad Request&#8221; response. If the client (enterprise edge element) includes any other MIME types in Accept header field other than &#8220;application/peering-info+json&#8221; or &#8220;application/peering-info+xml&#8221;, the capability set MUST reject the request with a &#8220;406 Not Acceptable&#8221; response.  </p>
<p id="rfc.section.6.5.p.2">The capability server can respond to client requests with redirect responses, specifically, the server can respond with the following redirect responses: </p>
<p></p>

<ol>
<li>301 Moved Temporarily</li>
<li>302 Found</li>
<li>307 Temporary Redirect</li>
</ol>

<p> </p>
<p id="rfc.section.6.5.p.4">The server SHOULD include the Location header field in such responses.  </p>
<p id="rfc.section.6.5.p.5">For requests that carry an invalid bearer token in the Authorization header field, the capability server SHOULD respond with a HTTP 401 status code.  </p>
<h1 id="rfc.section.6.6">
<a href="#rfc.section.6.6">6.6.</a> <a href="#identifying-the-request-target" id="identifying-the-request-target">Identifying the Request Target</a>
</h1>
<p id="rfc.section.6.6.p.1">HTTPS GET requests from enterprise edge elements MUST carry a valid request-target. The enterprise edge element might obtain the URL of the resource hosted on the capability server in one of two ways: </p>
<p></p>

<ol><li>Manual Configuration 2. Using the WebFinger Protocol</li></ol>

<p> </p>
<p id="rfc.section.6.6.p.3">The complete HTTPS URLs to be used when authenticating the enterprise edge element (optional) and obtaining the SIP service provider capability set can be obtained from the SIP service provider beforehand and entered into the edge element manually via some interface &#8211; for example, a CLI or GUI.  </p>
<p id="rfc.section.6.6.p.4">However, if the resource URL is unknown to the administrator (and by extension of that to the edge element), the WebFinger protocol <a href="#RFC7033" class="xref">[RFC7033]</a> may be leveraged. From the perspective of this draft, three link relation types (rel) are defined, namely: </p>
<p></p>

<ol><li>Capability Server: The base URL of the capability server hosting the capability set document. 2. Authorization Endpoint: The URL of the authorization endpoint to be used for OAuth 2.0 3. Token Endpoint: The URL of the token endpoint to be used for OAuth 2.0</li></ol>

<p> </p>
<p id="rfc.section.6.6.p.6">The corresponding link relation type values are as follows: </p>
<p></p>

<ol><li>Capability Server: &#8220;<span>&lt;</span><a href="http://sipserviceprovider/capserver%E2%80%9D">http://sipserviceprovider/capserver&#8221;</a><span>&gt;</span> 2.  Authorization Endpoint: &#8220;<span>&lt;</span><a href="http://sipserviceprovider/auth%E2%80%9D">http://sipserviceprovider/auth&#8221;</a><span>&gt;</span> 3. Token Endpoint: &#8220;<span>&lt;</span><a href="http://sipserviceprovider/token%E2%80%9D">http://sipserviceprovider/token&#8221;</a><span>&gt;</span>
</li></ol>

<p> </p>
<p id="rfc.section.6.6.p.8">If an enterprise edge element attempts to discover the URL of the endpoints hosted in the ssp1.example.com domain, it issues the following request (line wraps are for display purposes only) </p>
<pre>
    GET /.well-known/webfinger?
      resource=http%3A%2F%2Fssp1.example.com
      &amp;rel=http%3A%2f%2fsipserviceprovider%2fcapserver
      &amp;rel=http%3A%2f%2fsipserviceprovider%2auth
      &amp;rel= http%3A%2f%2fsipserviceprovider%2token
      HTTP/1.1
    Host: ssp1.example.com

</pre>
<p id="rfc.section.6.6.p.9">The response to the above request might be as follows: </p>
<pre>
    HTTP/1.1 200 OK
    Access-Control-Allow-Origin: *
    Content-Type: application/jrd+json
    {
      "subject" : "http://ssp1.example.com",
      "links" :
      [
        {
          "rel" : "http://sipserviceprovider/capserver",
          "href" : "https://capserver.ssp1.com"
        },
        {
          "rel" : "http://sipserviceprovider/auth",
          "href" : "https://ssp1.com/authorize"
        },
        {
          "rel" : "http://sipserviceprovider/token",
          "href" : "https://ssp1.com/token"
        }
      ]
    }
</pre>
<p id="rfc.section.6.6.p.10">SIP service providers MUST support the &#8220;https&#8221; URI and &#8220;acct&#8221; URI [link] schemes in WebFinger queries. The &#8220;acct&#8221; URI scheme might be used in the WebFinger query, if the enterprise adminsitrator is provided with a username by the SIP service provider. The SIP service provider might provide a unique username for each SIP purchased by the enterprise network or a single username that is applicable to all the trunks purchased by the enterprise network. This draft does not require SIP service providers or enterprise networks to favor one URI scheme over the other; rather, the choice of which scheme to use is left to the discretion of the SIP service provider. The security considerations of using the &#8220;acct&#8221; URI is provided in section 5 of <a href="#RFC7565" class="xref">[RFC7565]</a>.  </p>
<p id="rfc.section.6.6.p.11">The base URL of the capability server returned in the WebFinger response SHOULD not contain a path or query component. Once the base URL is obtained, the enterprise edge element builds on the base URL to identify the capability set document on the capability server. The general format for identifying resources on a capability server is as follows: </p>
<pre>
&lt;scheme&gt; /&lt;baseURL&gt;/&lt;path&gt;?&lt;query&gt;
</pre>
<p id="rfc.section.6.6.p.12">scheme: Is always HTTPS in the context of this draft.  </p>
<p id="rfc.section.6.6.p.13">baseURL: The base URL of the capability server discovered as a result of the WebFinger query.  </p>
<p id="rfc.section.6.6.p.14">path: The path expression identifying the capability set document on the capability server. The path expression MUST be set to the static string of &#8220;capdoc&#8221;.  </p>
<p id="rfc.section.6.6.p.15">query: A query string identifying a specific representation of the capability set document. The format of the query string is in the form of a &#8220;name=value&#8221; pair. This draft defines the following optional query parameter: </p>
<p id="rfc.section.6.6.p.16">trunkid: A parameter uniquely identifying the SIP trunk for which the capability set document is sought.  </p>
<p id="rfc.section.6.6.p.17">The &#8220;trunkid&#8221; is useful in situations in which an enterprise SIP network has multiple SIP trunks with the SIP service provider, such that parameters for such trunks vary, perhaps because of the geographical distribution of these sites. The value of the &#8220;trunkid&#8221; parameter is generated by the SIP service provider and communicated to the enterprise SIP network by some out-of-band mechanism, for example, it may be provided in an email to the enterprise administrator after the trunk is purchased. It is recommended that SIP service providers generate unique trunk identifiers across enterprise networks.  </p>
<p id="rfc.section.6.6.p.18">It is recommended that SIP service provider networks support the &#8220;trunkid&#8221; query parameter. SIP service providers expose varying capability sets to different enterprise SIP telephony networks. Using the &#8220;trunkid&#8221; query parameter not only helps the SIP service provider capability server to uniquely identify the trunk/enterprise/edge element for which the capability set document is being request, but also, it is helpful in generating unique URL strings for capability set documents.  These unique URL strings are helpful in HTTP content caching.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#state-deltas" id="state-deltas">State Deltas</a>
</h1>
<p id="rfc.section.7.p.1">Given that the service provider capability set is largely expected to remain static, the work needed to implement an asynchronous push mechanism to encode minor changes in the capability set document (state deltas) is not commensurate with the benefits. Rather, enterprise edge elements can poll capability servers at pre-defined intervals to obtain the full capability set document. It is recommended that capability servers are polled every 24 hours.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#encoding-the-service-provider-capability-set" id="encoding-the-service-provider-capability-set">Encoding the Service Provider Capability Set</a>
</h1>
<p id="rfc.section.8.p.1">In the context of this draft, the capability set of a service provider refers collectively to a set of characteristics which when communicated to an enterprise network, provides it with sufficient information to directly peer with the service provider network. The capability set document is not designed to encode extremely granular details of all features, services, and protocol extensions that are supported by the service provider network. For example, it is sufficient to encode that the service provider uses T.38 relay for faxing, it is not required to know the value of the &#8220;T38FaxFillBitRemoval&#8221; parameter.  </p>
<p id="rfc.section.8.p.2">The parameters within the capability set document represent a wide array of characteristics, such that these characteristics collectively disseminate sufficient information to enable direct IP peering between enterprise and service provider networks. The various parameters represented in the capability set are chosen based on existing practises and common problem sets typically seen between enterprise and service provider SIP networks.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#data-model-for-capability-set" id="data-model-for-capability-set">Data Model for Capability Set</a>
</h1>
<p id="rfc.section.9.p.1">This section defines a YANG module for encoding the service provider capability set. Section 9.1 provides the tree diagram, which is followed by a description of the various nodes within the module defined in this draft.  </p>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> <a href="#tree-diagram" id="tree-diagram">Tree Diagram</a>
</h1>
<p id="rfc.section.9.1.p.1">This section provides a tree diagram <a href="#RFC8340" class="xref">[RFC8340]</a> for the &#8220;ietf-capability-set&#8221; module. The interpretation of the symbols appearing in the tree diagram is as follows: </p>
<p></p>

<ul>
<li>Brackets &#8220;[&#8221; and &#8220;]&#8221; enclose list keys.</li>
<li>Abbreviations before data node names: &#8220;rw&#8221; means configuration (read-write), and &#8220;ro&#8221; means state data (read-only).</li>
<li>Symbols after data node names: &#8220;?&#8221; means an optional node, &#8220;!&#8221; means a presence container, and &#8220;*&#8221; denotes a list and leaf-list.</li>
<li>Parentheses enclose choice and case nodes, and case nodes are also marked with a colon (&#8220;:&#8221;).</li>
<li>Ellipsis (&#8220;&#8230;&#8221;) stands for contents of subtrees that are not shown.</li>
</ul>

<p> </p>
<p id="rfc.section.9.1.p.3">The data model for the peering capability document has the following structure: </p>
<pre>
  +--rw peering-response
     +--rw variant           string
     +--rw transport-info
     |  +--rw transport?        enumeration
     |  +--rw registrar*        host-port
     |  +--rw registrarRealm?   string
     |  +--rw callControl*      host-port
     |  +--rw dns*              inet:ip-address
     |  +--rw outboundProxy?    host-port
     +--rw call-specs
     |  +--rw earlyMedia?         boolean
     |  +--rw signalingForking?   boolean
     |  +--rw supportedMethods?   string
     +--rw media
     |  +--rw mediaTypeAudio
     |  |  +--rw mediaFormat*   string
     |  +--rw fax
     |  |  +--rw protocol*   enumeration
     |  +--rw rtp
     |  |  +--rw RTPTrigger?     boolean
     |  |  +--rw symmetricRTP?   boolean
     |  +--rw rtcp
     |     +--rw symmetricRTCP?   boolean
     |     +--rw RTCPfeedback?    boolean
     +--rw dtmf
     |  +--rw payloadNumber?   int8
     |  +--rw iteration?       boolean
     +--rw security
     |  +--rw signaling?       string
     |  +--rw mediaSecurity
     |     +--rw keyManagement?   string
     +--rw extensions?       string     
</pre>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> <a href="#yang-model" id="yang-model">YANG Model</a>
</h1>
<p id="rfc.section.9.2.p.1">This section defines the YANG module for the peering capability set document. It imports modules (ietf-yang-types and ietf-inet-types) from <a href="#RFC6991" class="xref">[RFC6991]</a>.  </p>
<pre>
    module ietf-peering {
      namespace "urn:ietf:params:xml:ns:ietf-peering";
      prefix "peering";

      description
      "Data model for transmitting peering parameters from SP to Enterprise";

      revision 2019-05-06 {
        description "Initial revision of peering-response doc.";
      }
            
      import ietf-inet-types {
        prefix "inet";
      }           
  
      typedef ipv4-address-port {
        type string {
          pattern '(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}'
          +  '([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])'
          + ':^()([1-9]|[1-5]?[0-9]{2,4}|6[1-4][0-9]{3}|65[1-4][0-9]{2}|655[1-2][0-9]|6553[1-5])$';
        }
        description "The ipv4-address-port type represents an IPv4 address in
        dotted-quad notation followed by a port number.";
      }
  
      typedef ipv6-address-port {
        type string {
          pattern '((:|[0-9a-fA-F]{0,4}):)([0-9a-fA-F]{0,4}:){0,5}'
          + '((([0-9a-fA-F]{0,4}:)?(:|[0-9a-fA-F]{0,4}))|'
          + '(((25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])\.){3}'
          + '(25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])))'
          + ':^()([1-9]|[1-5]?[0-9]{2,4}|6[1-4][0-9]{3}|65[1-4][0-9]{2}|655[1-2][0-9]|6553[1-5])$';
          pattern 
          '(([^:]+:){6}(([^:]+:[^:]+)|(.*\..*)))|'
          + '((([^:]+:)*[^:]+)?::(([^:]+:)*[^:]+)?)'
          + ':^()([1-9]|[1-5]?[0-9]{2,4}|6[1-4][0-9]{3}|65[1-4][0-9]{2}|655[1-2][0-9]|6553[1-5])$';
        }
          description 
          "The ipv6-address type represents an IPv6 address in full,
          mixed, shortened, and shortened-mixed notation followed by a port number.";
      }
  
      typedef ip-address-port {
        type union {
          type ipv4-address-port;
          type ipv6-address-port;
        }
        description 
        "The ip-address-port type represents an IP address:port number
        and is IP version neutral.";
      }
  
      typedef domain-name-port {
        type string {
          pattern
          '((([a-zA-Z0-9_]([a-zA-Z0-9\-_]){0,61})?[a-zA-Z0-9]\.)*'
          + '([a-zA-Z0-9_]([a-zA-Z0-9\-_]){0,61})?[a-zA-Z0-9]\.?)'
          + '|\.'
          + ':^()([1-9]|[1-5]?[0-9]{2,4}|6[1-4][0-9]{3}|65[1-4][0-9]{2}|655[1-2][0-9]|6553[1-5])$';
          length "1..258";
        }
        description
        "The domain-name-port type represents a DNS domain name followed by a port number.
        The name SHOULD be fully qualified whenever possible.";
      }
  
      typedef host-port {
        type union {
          type ip-address-port;
          type domain-name-port;
        }
        description
        "The host type represents either an IP address or a DNS
        domain name followed by a port number.";
      }
  
      container peering-info {
        leaf variant {
          type string;
          mandatory true;
          description "Variant of peering-response document";
        }
            
        container transport-info {
          leaf transport {
            type enumeration {
              enum "TCP";
              enum "TLS";
              enum "UDP";
              enum "TCP;TLS";
              enum "TCP;TLS;UDP";
              enum "TCP;UDP";
            }
            description "Transport Protocol(s) used in SIP communication";
          }
            
          leaf-list registrar {
            type host-port;
            max-elements 3;
            description "List of service provider registrar servers";
          }
            
          leaf registrarRealm {
            type string;
            description "Realm for REGISTER requests carrying credentials";
          }
            
          leaf-list callControl {
            type host-port;
            max-elements 3;
            description "List of service provider call control servers";
          }
            
          leaf-list dns {
            type inet:ip-address;
            max-elements 2;
            description "IP address of the DNS Server(s) hosted by the service provider";
          }
            
          leaf outboundProxy {
            type host-port;
            description "SIP Outbound Proxy";
          }                             
        }
    
        container call-specs {
          leaf earlyMedia {
            type boolean;
            description "Flag indicating whether the service provider is expected
            to deliver early media.";
          }

          leaf signalingForking {
            type boolean;
            description "Flag indicating whether the service provider is capable
            of forking incoming calls ";
          }
            
          leaf supportedMethods {
            type string;
            description "Leaf/Leaf List indicating the different SIP methods
            support by the service provider.";
          }
        }
    
        container media {
          container mediaTypeAudio {
            leaf-list mediaFormat {
              type string;
              description "Leaf List indicating the audio media formats supported.";
            }
          }
                 
          container fax {
            leaf-list protocol {
              type enumeration {
                enum "pass-through";
                enum "t38";
              }
              max-elements 2;
              description "Leaf List indicating the different fax protocols
              supported by the service provider.";
            }
          }
      
          container rtp {
            leaf RTPTrigger {
              type boolean;
              description "Flag indicating whether the service provider expects to 
              receive the first media packet.";
            }
            
            leaf symmetricRTP {
              type boolean;
              description "Flag indicating whether the service provider expects 
              symmetric RTP defined in [@RFC4961]";
            }
          }
    
          container rtcp {
            leaf symmetricRTCP {
              type boolean;
              description " Flag indicating whether the service provider expects 
              symmetric RTP defined in [@RFC4961].";
            }
            
            leaf RTCPfeedback {
              type boolean;
              description "Flag Indicating support for RTP profile extension for 
              RTCP-based feedback, as defined in [@RFC4585]";
            }
          }
        }

        container dtmf {
          leaf payloadNumber {
            type int8 {
              range "96..127";
            }
            description "Leaf that indicates the payload number(s) supported by 
            the service provider for DTMF relay via Named-Telephony-Events";
          }

          leaf iteration {
            type boolean;
            description "Flag identifying whether the service provider supports 
            NTE DTMF relay using the procedures of [@RFC2833] or [@RFC4733] .";
          }
        }
    
        container security {
          container signaling {
            leaf type {
              type string {
                pattern "TLS";
              }
              description "Type of signaling security supported.";
            }
            
            leaf version {
              type string {
                pattern "([1-9]\.[0-9])(;[1-9]\.[0-9])?|(NULL)";
              }
              description "Indicates TLS version for SIP signaling";
            }
          }   
    
          container mediaSecurity {
            leaf keyManagement {
              type string {
                pattern "(SDES(;DTLS-SRTP,version=[1-9]\.[0-9](,[1-9]\.[0-9])?)?)|(DTLS-SRTP,version=[1-9]\.[0-9](,[1-9]\.[0-9])?)|(NULL)";
              }
              description "Leaf that identifies the key management methods 
              supported by the service provider for SRTP.";
            }
          }
        }
    
        leaf extensions {
          type string;
          description "Lists the various SIP extensions supported by SP";
        }
      }
    }
</pre>
<h1 id="rfc.section.9.3">
<a href="#rfc.section.9.3">9.3.</a> <a href="#node-definitions" id="node-definitions">Node Definitions</a>
</h1>
<p id="rfc.section.9.3.p.1">This sub-sections provides the definition and encoding rules of the various nodes of the YANG module defined in section 9.2 </p>
<p></p>

<ul>
<li>
<strong>capability-set</strong>: This node serves as a container for all the other nodes in the YANG module; the capability-set node is akin to the root element of an XML schema.</li>
<li>
<strong>variant</strong>: This node identifies the version number of the capability set document. This draft defines the parameters for variant 1.0; future specifications might define a richer parameter set, in which case the variant can be changed to 2.0, 3.0 and so on. Future extensions to the capability set document MUST also ensure that the corresponding YANG module is defined.</li>
<li>
<strong>transport-info</strong>: The transport-info node is a container that encapsulates transport characteristics of SIP sessions between enterprise and service provider networks.</li>
<li>
<strong>transport</strong>: A leaf node that enumerates the different Transport Layer protocols supported by the SIP service provider. Valid transport layer protocols include: UDP, TCP, TLS or a combination of them (with the exception of TLS and UDP).</li>
<li>
<strong>registrar</strong>: A leaf-list that specifies the transport address of one or more registrar servers in the service provider network. The transport address of the registrar can be provided using a combination of a valid IP address and port number, or a subdomain of the SIP service provider network, or the fully qualified domain name (FQDN) of the SIP service provider network. If the transport address of a registrar is specified using either a subdomain or a fully qualified domain name, the DNS element needs to be populated with one or more valid DNS server IP addresses.</li>
<li>
<strong>callControl</strong>: A leaf-list that specifies the transport address of the call server(s) in the service provider network. The enterprise network MUST use an applicable transport protocol in conjunction with the call control server(s) transport address when transmitting call setup requests. The transport address of a call server(s) within the service provider network can be specified using a combination of a valid IP address and port number, or a subdomain of the SIP service provider network, or a fully qualified domain name of the SIP service provider network. If the transport address of a call control server(s) is specified using either a subdomain or a fully qualified domain name, the DNS element MUST be populated with one or more valid DNS server IP addresses. The transport address specified in this element can also serve as the target for non-call requests such as SIP OPTIONS.</li>
<li>
<strong>dns</strong>: A leaf list that encodes the IP address of one or more DNS servers hosted by the SIP service provider. If the enterprise network is unaware of the IP address, port number, and transport protocol of servers within the service provider network (for example, the registrar and call control server), it MUST use DNS NAPTR and SRV. Alternatively, if the enterprise network has the fully qualified domain name of the SIP service provider network, it MUST use DNS to resolve the said FQDN to an IP address. The dns element encodes the IP address of one or more DNS servers hosted in the service provider network. If however, either the registrar or callControl elements or both are populated with a valid IP address and port pair, the dns element MUST be set to the quadruple octet of 0.0.0.0.</li>
<li>
<strong>outboundProxy</strong>: A leaf list that specifies the transport address of one or more outbound proxies. The transport address can be specified by using a combination of an IP address and a port number, a subdomain of the SIP service provider network, or a fully qualified domain name and port number of the SIP service provider network. If the outbound-proxy sub-element is populated with a valid transport address, it represents the default destination for all outbound SIP requests and therefore, the registrar and callControl elements MUST be populated with the quadruple octet of 0.0.0.0.</li>
<li>
<strong>call-specs</strong>: A container that encapsulates information about call specifications, restrictions and additional handling criteria for SIP calls between the enterprise and service provider network.</li>
<li>
<strong>earlyMedia</strong>: A leaf that specifies whether the service provider network is expected to deliver in-band announcements/tones before call connect. The P-Early-Media header field can be used to indicate pre-connect delivery of tones and announcements on a per-call basis.  However, given that signalling and media could traverse a large number of intermediaries with varying capabilities (in terms of handling of the P-Early-Media header field) within the enterprise, such devices can be appropriately configured for media cut through if it is known before-hand that early media is expected for some or all of the outbound calls. This element is a Boolean type, where a value of 1/true signifies that the service provider is capable of early media. A value of 0/false signifies that the service provider is not expected to generate early media.</li>
<li>
<strong>signalingForking</strong>: A leaf that specifies whether outbound call requests from the enterprise might be forked on the service provider network leading to multiple early dialogs. This information would be useful to the enterprise network in appropriately handling multiple early dialogs reliably and in enforcing local policy. This element is a Boolen type, where a value of 1/true signifies that the service provider network can potentially fork outbound call requests from the enterprise.  A value of 0/false indicates that the service provider will not fork outbound call requests.</li>
<li>
<strong>supportedMethods</strong>: A leaf node that specifies the various SIP methods supported by the SIP service provider. The list of supported methods help to appropriately configuration various devices within the enterprise network. For example, if the service provider enumerates support for the OPTIONS method, the enterprise network could periodically send OPTIONS requests as a keep-alive mechanism.</li>
<li>
<strong>media</strong>: A container that is used to collectively encapsulate the characteristics of UDP-based audio and video streams. A future extension to this draft may extend the media container to describe other media types. The media container is also used to encapsulate basic information about Real-Time Transport Protocol (RTP) and Real-Time Transport Control Protocol (RTCP) from the perspective of the service provider network.</li>
<li>
<strong>mediaTypeAudio</strong>: A container for the mediaFormat leaf-list. This container collectively encapsulates the various audio media formats supported by the SIP service provider.</li>
<li>
<strong>mediaFormat</strong>: A leaf-list encoding the various audio media formats supported by the SIP service provider. The relative ordering of different media format leaf nodes from left to right indicates preference from the perspective of the service provider. Each mediaFormat node begins with the encoding name of the media format, which is the same encoding name as used in the &#8220;RTP/AVP&#8221; and &#8220;RTP/SAVP&#8221; profiles. The encoding name is followed by required and optional parameters for the given media format as specified when the media format is registered <a href="#RFC4855" class="xref">[RFC4855]</a>. Given that the parameters of media formats can vary from one communication session to another, for example, across two separate communication sessions, the packetization time (ptime) used for the PCMU media format might vary from 10 to 30 ms, the parameters included in the format element MUST be the ones that are expected to be invariant from the perspective of the service provider. Providing information about supported media formats and their respective parameters, allows enterprise networks to configure the media plane characteristics of various devices such as endpoints and middleboxes.  The encoding name, one or more required parameters, one or more optional parameters are all separated by a semicolon. The formatting of a given media format parameter, MUST follow the formatting rules as specified for that media format.</li>
<li>
<strong>fax</strong>: A container that encapsulates the fax protocol(s) supported by the SIP service provider. The fax container encloses a leaf-list (named protocol) that enumerates whether the service provider supports t38 relay, protocol-based fax passthrough or both. The relative ordering of leaf nodes within the leaf lists indicates preference.</li>
<li>
<strong>rtp</strong>: A container that encapsulates generic characteristics of RTP sessions between the enterprise and service provider network. This node is a container for the &#8220;RTPTrigger&#8221; and &#8220;SymmetricRTP&#8221; leaf nodes.</li>
<li>
<strong>RTPTrigger</strong>: A leaf node indicating whether the SIP service provider network always expects the enterprise network to send the first RTP packet for an established communication session. This information is useful in scenarios such as &#8220;hairpinned&#8221; calls, in which the caller and callee are on the service provider network and because of sub-optimal media routing, an enterprise device such as an SBC is retained in the media path. Based on the encoding of this node, it is possible to configure enterprise devices such as SBCs to start streaming media (possibly filled with silence payloads) toward the address:port tuples provided by caller and callee. This node is a Boolean type. A value of 1/true indicates that the service provider expects the enterprise network to send the first RTP packet, whereas a value of 0/false indicates that the service provider network does not require the enterprise network to send the first media packet. While the practise of preserving the enterprise network in a hairpinned call flow is fairly common, it is recommended that SIP service providers avoid this practise. In the context of a hairpinned call, the enterprise device retained in the call flow can easily eavesdrop on the conversation between the offnet parties.</li>
<li>
<strong>symmetricRTP</strong>: A leaf node indicating whether the SIP service provider expects the enterprise network to use symmetric RTP as defined in <a href="#RFC4961" class="xref">[RFC4961]</a>. Uncovering this expectation is useful in scenarios where &#8220;latching&#8221; <a href="#RFC3762" class="xref">[RFC3762]</a> is implemented in the service provider network.  This node is a Boolean type, a value of 1/true indicates that the service provider expects the enterprise network to use symmetric RTP, whereas a value of 0/false indicates that the enterprise network can use asymmetric RTP.</li>
<li>
<strong>rtcp</strong>: A container that encapsulates generic characteristics of RTCP sessions between the enterprise and service provider network. This node is a container for the &#8220;RTCPFeedback&#8221; and &#8220;SymmetricRTCP&#8221; leaf nodes.</li>
<li>
<strong>RTCPFeedback</strong>: A leaf node that indicates whether the SIP service provider supports the RTP profile extension for RTCP-based feedback <a href="#RFC4585" class="xref">[RFC4585]</a>. Media sessions spanning enterprise and service provider networks, are rarely made to flow directly between the caller and callee, rather, it is often the case that media traffic flows through network intermediaries such as SBCs. As a result, RTCP traffic from the service provider network is intercepted by these intermediaries, which in turn can either pass across RTCP traffic unmodified or modify RTCP traffic before it is forwarded to the endpoint in the enterprise network. Modification of RTCP traffic would be required, for example, if the intermediary has performed media payload transformation operations such as transcoding or transrating. In a similar vein, for the RTCP-based feedback mechanism as defined in <a href="#RFC4585" class="xref">[RFC4585]</a> to be truly effective, intermediaries MUST ensure that feedback messages are passed reliably and with the correct formatting to enterprise endpoints. This might require additional configuration and considerations that need to be dealt with at the time of provisioning the intermediary device. This node is a Boolean type, a value of 1/true indicates that the service provider supports the RTP profile extension for RTP-based feedback and a value of 0/false indicates that the service provider does not support the RTP profile extension for RTP-based feedback.</li>
<li>
<strong>symmetricRTCP</strong>: A leaf node indicating whether the SIP service provider expects the enterprise network to use symmetric RTCP as defined in <a href="#RFC4961" class="xref">[RFC4961]</a>. This node is a Boolean type, a value of 1 indicates that the service provider expects symmetric RTCP reports, whereas a value of 0 indicates that the enterprise can use asymmetric RTCP.</li>
<li>
<strong>dtmf</strong>: A container that describes the various aspects of DTMF relay via RTP Named Telephony Events. The dtmf container allows SIP service providers to specify two facets of DTMF relay via Named Telephony Events:</li>
</ul>

<p> </p>
<p></p>

<ol><li>The payload type number using the payloadNumber leaf node. 2. Support for <a href="#RFC2833" class="xref">[RFC2833]</a> or <a href="#RFC4733" class="xref">[RFC4733]</a> using the iteration leaf node.</li></ol>

<p> </p>
<p id="rfc.section.9.3.p.4">In the context of named telephony events, senders and receivers may negotiate asymmetric payload type numbers. For example, the sender might advertise payload type number 97 and the receiver might advertise payload type number 101. In such instances, it is either required for middleboxes to interwork payload type numbers or allow the endpoints to send and receive asymmetric payload numbers. The behaviour of middleboxes in this context is largely dependent on endpoint capabilities or on service provider constraints. Therefore, the payloadNumber leaf node can be used to determine middlebox configuration before-hand.  </p>
<p><a href="#RFC4733" class="xref">[RFC4733]</a>iterates over <a href="#RFC2833" class="xref">[RFC2833]</a> by introducing certain changes in the way NTE events are transmitted. SIP service providers can indicate support for <a href="#RFC4733" class="xref">[RFC4733]</a> by setting the iteration flag to 1 or indicating support for <a href="#RFC2833" class="xref">[RFC2833]</a> by setting the iteration flag to 0.  </p>
<p></p>

<ul>
<li>
<strong>security</strong>: A container that encapsulates characteristics about encrypting signalling streams between the enterprise and SIP service provider networks.</li>
<li>
<strong>signaling</strong>: A container that encapsulates the type of security protocol for the SIP communication between the enterprise SBC and the service provider.</li>
<li>
<strong>type</strong>: A leaf node that specifies the protocol used for protecting SIP signalling messages between the enterprise and service provider network. The value of the type leaf node is only defined for Transport Layer Security (TLS). Accordingly, if TLS is allowed for SIP sessions between the enterprise and service provider network, the type leaf node is set to the string &#8220;tls&#8221;.</li>
<li>
<strong>version</strong>: A leaf node that specifies the version(s) of TLS supported in decimal format. If multiple versions of TLS are supported, they MUST be separated by semi-colons. If the service provide does not support TLS for protecting SIP sessions, the signalling element is set to the string &#8220;NULL&#8221;.</li>
<li>
<strong>mediaSecurity</strong>: A container that describes the various characteristics of securing media streams between enterprise and service provider networks.</li>
<li>
<strong>keyManagement</strong>: A leaf node that specifies the key management method used by the service provider. Possible values of this node include: &#8220;SDES&#8221; and &#8220;DTLS-SRTP&#8221;. A value of &#8220;SDES&#8221; signifies that the SIP service provider uses the methods defined in <a href="#RFC4568" class="xref">[RFC4568]</a> for the purpose of key management. A value of &#8220;DTLS-SRTP&#8221; signifies that the SIP service provider uses the methods defined in <a href="#RFC5764" class="xref">[RFC5764]</a> for the purpose of key management. If the value of this leaf node is set to &#8220;DTLS-SRTP&#8221;, the various versions of DTLS supported by the SIP service provider MUST be encoded as per the formatting rules of Section 9.2. If the service provider does not support media security, the keyManagement node MUST be set to &#8220;NULL&#8221;.</li>
<li>
<strong>extensions</strong>: A leaf node that is a semicolon separated list of all possible SIP option tags supported by the service provider network.  These extensions MUST be referenced using name registered under IANA. If the service provider network does not support any extensions to baseline SIP, the extensions node MUST be set to &#8220;NULL&#8221;.</li>
</ul>

<p> </p>
<h1 id="rfc.section.9.4">
<a href="#rfc.section.9.4">9.4.</a> <a href="#extending-the-capability-set" id="extending-the-capability-set">Extending the Capability Set</a>
</h1>
<p id="rfc.section.9.4.p.1">There are situations in which equipment manufactures or service providers would benefit from extending the YANG module defined in this draft. For example, service providers could extend the YANG module to include information that further simplifies direct IP peering. Such information could include: trunk group identifiers, direct-inward-dial (DID) number ranges allocated to the enterprise, customer/enterprise account numbers, service provider support numbers, among others.  </p>
<p id="rfc.section.9.4.p.2">Extension of the module can be achieved by importing the module defined in this draft. An example is provided below: </p>
<p id="rfc.section.9.4.p.3">Consider a new YANG module &#8220;vendorA&#8221; specified for VendorA&#8217;s enterprise SBC. The &#8220;vendorA-config&#8221; YANG module is configured as follows: </p>
<pre>
    module vendorA-config {
      namespace "urn:ietf:params:xml:ns:yang:vendorA-config";
      prefix "vendorA";

      description
      "Data model for configuring VendorA Enterprise SBC";

      revision 2020-05-06 {
      description "Initial revision of VendorA Enterprise SBC configuration data model";
      }
  
      import ietf-peering {
        prefix "peering";
      }
  
      augment "/peering:peering-info" {
        container vendorAConfig {
          leaf vendorAConfigParam1 {
            type int32;
            description "vendorA configuration parameter 1 (SBC Device ID)";
          }
      
          leaf vendorAConfigParam2 {
            type string;
              description "vendorA configuration parameter 2 (SBC Device name)";
          }
          description "Container for vendorA SBC configuration";
        }
      }      
    }     
</pre>
<p id="rfc.section.9.4.p.4">In the example above, a custom module named &#8220;vendorA-config&#8221; uses the &#8220;augment&#8221; statement as defined in Section 4.2.8 of <a href="#RFC7950" class="xref">[RFC7950]</a> to extend the module defined in this draft.  </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#example-capability-set-document-encoding" id="example-capability-set-document-encoding">Example Capability Set Document Encoding</a>
</h1>
<p id="rfc.section.10.p.1">This section provides examples of how capability set documents that leverage the YANG module defined in this document can be encoded over JSON or XML.  </p>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> <a href="#json-capability-set-document" id="json-capability-set-document">JSON Capability Set Document</a>
</h1>
<pre>
    {       
      "peering-info:variant": "1.0",
      "transport-info": {
        "transport": "TCP;TLS;UDP",
        "registrar": ["registrar1.voip.example.com:5060", "registrar2.voip.example.com:5060"],
        "registrarRealm": "voip.example.com",
        "callControl": ["callServer1.voip.example.com:5060", "192.168.12.25:5065"],
        "dns": [8.8.8.8, 208.67.222.222],
        "outboundProxy": "0.0.0.0"
      },
      "call-specs": {
        "earlyMedia": "true",
        "signalingForking": "false",
        "supportedMethods": "INVITE;OPTIONS;BYE;CANCEL;ACK;PRACK;SUBSCRIBE;NOTIFY;REGISTER"
      },
      "media": {
        "mediaTypeAudio": {
          "mediaFormat": ["PCMU;rate=8000;ptime=20","G729;rate=8000;annexb=yes","G722;rate=8000;bitrate=56k,64k"]
        },
        "fax": {
          "protocol": ["pass-through", "t38"]
        },
        "rtp": {
          "RTPTrigger": "false",
          "symmetricRTP": "true"
        },
        "rtcp": {
          "symmetricRTCP": "true",
          "RTCPFeedback": "true"
        }
      },
      "dtmf": {
        "payloadNumber": "101",
        "iteration": "0"
      },
      "security": {
        "signaling": {
          "type": "TLS",
          "version": "1.0;1.2"
        },
        "mediaSecurity": {
          "keyManagement": "SDES;DTLS-SRTP,version=1.2"
        }
      },
      "extensions": "timer;rel100;gin;path"
    } 
</pre>
<h1 id="rfc.section.10.2">
<a href="#rfc.section.10.2">10.2.</a> <a href="#xml-capability-set-document" id="xml-capability-set-document">XML Capability Set Document</a>
</h1>
<pre>
    &lt;peering-info xmlns="urn:ietf:params:xml:ns:yang:ietf-peering"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="urn:ietf:params:xml:ns:yang:ietf-peering ietf-peering.xsd"&gt;
      &lt;variant&gt;1.0&lt;/variant&gt;
      &lt;transport-info&gt;
        &lt;transport&gt;TCP;TLS;UDP&lt;/transport&gt;
        &lt;registrar&gt;registrar1.voip.example.com:5060&lt;/registrar&gt;
        &lt;registrar&gt;registrar2.voip.example.com:5060&lt;/registrar&gt;
        &lt;registrarRealm&gt;voip.example.com&lt;/registrarRealm&gt;
        &lt;callControl&gt;callServer1.voip.example.com:5060&lt;/callControl&gt;
        &lt;callControl&gt;192.168.12.25:5065&lt;/callControl&gt;
        &lt;dns&gt;8.8.8.8&lt;/dns&gt;
        &lt;dns&gt;208.67.222.222&lt;/dns&gt;
        &lt;outboundProxy&gt;0.0.0.0&lt;/outboundProxy&gt;
      &lt;/transport-info&gt;
      &lt;call-specs&gt;
        &lt;earlyMedia&gt;true&lt;/earlyMedia&gt;
        &lt;signalingForking&gt;false&lt;/signalingForking&gt;
        &lt;supportedMethods&gt;INVITE;OPTIONS;BYE;CANCEL;ACK;PRACK;SUBSCRIBE;NOTIFY;REGISTER&lt;/supportedMethods&gt;
      &lt;/call-specs&gt;
      &lt;media&gt;
        &lt;mediaTypeAudio&gt;
          &lt;mediaFormat&gt;PCMU;rate=8000;ptime=20&lt;/mediaFormat&gt;
          &lt;mediaFormat&gt; G729;rate=8000;annexb=yes&lt;/mediaFormat&gt;
          &lt;mediaFormat&gt;G722;rate=8000;bitrate=56k,64k&lt;/mediaFormat&gt;
        &lt;/mediaTypeAudio&gt;
        &lt;fax&gt;
          &lt;protocol&gt;pass-through&lt;/protocol&gt;
          &lt;protocol&gt;t38&lt;/protocol&gt;
        &lt;/fax&gt;
        &lt;rtp&gt;
          &lt;RTPTrigger&gt;true&lt;/RTPTrigger&gt;
          &lt;symmetricRTP&gt;true&lt;/symmetricRTP&gt;
        &lt;/rtp&gt;
        &lt;rtcp&gt;
          &lt;symmetricRTCP&gt;true&lt;/symmetricRTCP&gt;
          &lt;RTCPFeedback&gt;true&lt;/RTCPFeedback&gt;
        &lt;/rtcp&gt;
      &lt;/media&gt;
      &lt;dtmf&gt;
        &lt;payloadNumber&gt;101&lt;/payloadNumber&gt;
        &lt;iteration&gt;0&lt;/iteration&gt;
      &lt;/dtmf&gt;
      &lt;security&gt;
        &lt;signaling&gt;
          &lt;type&gt;TLS&lt;/type&gt;
          &lt;version&gt;1.0;1.2&lt;/version&gt;
        &lt;/signaling&gt;
        &lt;mediaSecurity&gt;
          &lt;keyManagement&gt;SDES;DTLS-SRTP,version=1.2&lt;/keyManagement&gt;
          &lt;/mediaSecurity&gt;
        &lt;/security&gt;
      &lt;extensions&gt;timer;rel100;gin;path&lt;/extensions&gt;
    &lt;/peering-response&gt;
</pre>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#example-exchange" id="example-exchange">Example Exchange</a>
</h1>
<p id="rfc.section.11.p.1">This section depicts an example of the configuration flow that ultimately results in the enterprise edge element obtaining the capability set document from the SIP service provider.  </p>
<p id="rfc.section.11.p.2">Assuming the enterprise edge element isn&#8217;t pre-configured with the request target for the capability set document and is required to authenticate with the SIP service provider capability server, the following sequence of events are put into motion to obtain the capability set document: </p>
<p id="rfc.section.11.p.3">The enterprise edge element generates a WebFinger query to discover endpoints hosted in the ssp1.example.com domain (line wraps are for display purposes only) </p>
<pre>
    GET /.well-known/webfinger?
      resource=http%3A%2F%2Fssp1.example.com
      &amp;rel=http%3A%2f%2fsipserviceprovider%2fcapserver
      &amp;rel=http%3A%2f%2fsipserviceprovider%2auth
      &amp;rel= http%3A%2f%2fsipserviceprovider%2token
      HTTP/1.1
    Host: ssp1.example.com ```

The resulting WebFinger response, contains the URLs of the capability
server, the OAuth 2.0 authorization endpoint and OAuth 2.0 token
endpoint.

</pre>
<pre>
HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
Content-Type: application/jrd+json
{
  "subject" : "http://ssp1.example.com",
  "links" :
  [
    {
      "rel" : "http://sipserviceprovider/capserver",
      "href" : "https://capserver.ssp1.com"
    },
    {
      "rel" : "http://sipserviceprovider/auth",
      "href" : "https://ssp1.com/authorize"
    },
    {
      "rel" : "http://sipserviceprovider/token",
      "href" : "https://ssp1.com/token"
    },    
  ]
}
</pre>
<pre>

The endpoint URLs returned in the WebFinger response are stored by the
edge element and referenced when required. Then, the administrator logs
into the GUI of the edge element and initiates the download of the
service provider capability set (perhaps by clicking on a button). This
triggers the edge element to redirect the administrator to the OAuth 2.0
authorization endpoint (discovered via WebFinger). Once the
administrator is authenticated and provides authorization, flow is
redirected to the callback URL of the edge element application. The edge
element then contacts the OAuth 2.0 token endpoint (discovered via
WebFinger) to authenticate itself and obtain access and refresh tokens.
Accordingly, the edge element mints a JWT bearer token to authenticate
itself with the token endpoint and obtain an access and refresh token.
Below is an example of client authentication using a JWT during the
presentation of an authorization code grant for an access token request
(line wraps are for display purposes only).

</pre>
<pre>
POST /token  HTTP/1.1
Host: ssp1.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=n0esc3NRze7LTCu7iYzS6a5acc3f0ogp4&amp;
client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3A
client-assertion-type%3Ajwt-bearer&amp;
client_assertion=eyJhbGciOiJSUzI1NiIsImtpZCI6IjIyIn0.
eyJpc3Mi[...omitted for brevity...].
cC4hiUPo[...omitted for brevity...] ```
</pre>
<pre>

If the request is acceptable to the token endpoint, an access token and
a refresh token is provided in the response. For example:

</pre>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "access_token":"sF_9.B5f-4.1JqM",
  "token_type":"Bearer",
  "expires_in":86400,
  "refresh_token":"hGzv3JOkF0XG5Qx2TlKWIA"
}
</pre>
<pre>

The obtained bearer access token can subsequently be used to obtain the
capability set document for the capability server. The edge element
generates a HTTPS GET request with the bearer token included in the
Authorization header field.

</pre>
<pre>
GET //capdoc?trunkid=trunkent1456 HTTP/1.1
Host: capserver.ssp1.com
Authorization: Bearer mF_9.B5f-4.1JqM
Accept:application/peering-info+xml
</pre>
<pre>

The capability set document is obtained in the body of the response and
is encoded in XML.

</pre>
<pre>
HTTP/1.1 200 OK
Content-Type: application/peering-info+xml
Content-Length: nnn

&lt;peering-info&gt;
&#8230;
&lt;/peering-info&gt; 
</pre>
<p id="rfc.section.11.p.4">``` </p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.12.p.1">Capability set documents have a significant bearing on the quality of the peering relationship between an enterprise and service provider network. These documents can be modified by an attacker to drastically impact the quality of communication sessions between enterprise and service provider networks. Additionally, capability set documents contain parameters that may be considered sensitive from the perspective of the SIP service provider. For example, the YANG model defined in this document might be extended by SIP service providers to include account sensitive information such as the username and password to used when generating an MD5 response to 401/407 SIP challenges.  </p>
<p id="rfc.section.12.p.2">To ensure the problems discussed in the previous paragraph are accounted for, the following considerations MUST be taken into account: </p>
<p></p>

<ul><li>Integrity and Confidentiality</li></ul>

<p> </p>
<p id="rfc.section.12.p.4">Request and responses for the capability set documents are defined over HTTP. However, due to the sensitive nature of information transmitted between client and server, it is required to secure HTTP using Transport Layer Security. The enterprise edge element and capability server MUST be compliant to <a href="#RFC7235" class="xref">[RFC7235]</a>. The enterprise edge element and capability server MUST support the use of the https uri scheme as defined in <a href="#RFC7230" class="xref">[RFC7230]</a>.  </p>
<p></p>

<ul><li>Authenticated Client Identity</li></ul>

<p> </p>
<p id="rfc.section.12.p.6">While this draft does not enforce client authentication, there are situations in which client need to authenticated by SIP service providers before they are provided capability set documents. In such situations client MUST be authenticated using the procedures outlined in section 6.3 of this draft.  </p>
<p></p>

<ul><li>The &#8220;trunkid&#8221; parameter</li></ul>

<p> </p>
<p id="rfc.section.12.p.8">It is recommended that enterprise edge elements use the &#8220;trunkid&#8221; parameter in query strings when requesting for the capability set documents. The value of &#8220;trunkid&#8221; parameter is generated by the SIP service provider and provided to the administrator via some out-of-band mechanism. SIP service providers MUST ensure that value of the &#8220;trunkid&#8221; parameters does not inadvertently communicate sensitive information to an attacker such as a username or password credential.  </p>
<p id="rfc.section.12.p.9">In addition to the considerations listed above, all the security considerations that are part of the WebFinger and OAuth 2.0 specifications are applicable to this draft.  </p>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.13.p.1">TBD </p>
<h1 id="rfc.references">
<a href="#rfc.references">14.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">14.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6020">[RFC6020]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc6020">YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)</a>", RFC 6020, DOI 10.17487/RFC6020, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6991">[RFC6991]</b></td>
<td class="top">
<a>Schoenwaelder, J.</a>, "<a href="https://tools.ietf.org/html/rfc6991">Common YANG Data Types</a>", RFC 6991, DOI 10.17487/RFC6991, July 2013.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">14.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2833">[RFC2833]</b></td>
<td class="top">
<a>Schulzrinne, H.</a> and <a>S. Petrack</a>, "<a href="https://tools.ietf.org/html/rfc2833">RTP Payload for DTMF Digits, Telephony Tones and Telephony Signals</a>", RFC 2833, DOI 10.17487/RFC2833, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3762">[RFC3762]</b></td>
<td class="top">
<a>Levin, O.</a>, "<a href="https://tools.ietf.org/html/rfc3762">Telephone Number Mapping (ENUM) Service Registration for H.323</a>", RFC 3762, DOI 10.17487/RFC3762, April 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4568">[RFC4568]</b></td>
<td class="top">
<a>Andreasen, F.</a>, <a>Baugher, M.</a> and <a>D. Wing</a>, "<a href="https://tools.ietf.org/html/rfc4568">Session Description Protocol (SDP) Security Descriptions for Media Streams</a>", RFC 4568, DOI 10.17487/RFC4568, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4585">[RFC4585]</b></td>
<td class="top">
<a>Ott, J.</a>, <a>Wenger, S.</a>, <a>Sato, N.</a>, <a>Burmeister, C.</a> and <a>J. Rey</a>, "<a href="https://tools.ietf.org/html/rfc4585">Extended RTP Profile for Real-time Transport Control Protocol (RTCP)-Based Feedback (RTP/AVPF)</a>", RFC 4585, DOI 10.17487/RFC4585, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4733">[RFC4733]</b></td>
<td class="top">
<a>Schulzrinne, H.</a> and <a>T. Taylor</a>, "<a href="https://tools.ietf.org/html/rfc4733">RTP Payload for DTMF Digits, Telephony Tones, and Telephony Signals</a>", RFC 4733, DOI 10.17487/RFC4733, December 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4855">[RFC4855]</b></td>
<td class="top">
<a>Casner, S.</a>, "<a href="https://tools.ietf.org/html/rfc4855">Media Type Registration of RTP Payload Formats</a>", RFC 4855, DOI 10.17487/RFC4855, February 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4961">[RFC4961]</b></td>
<td class="top">
<a>Wing, D.</a>, "<a href="https://tools.ietf.org/html/rfc4961">Symmetric RTP / RTP Control Protocol (RTCP)</a>", BCP 131, RFC 4961, DOI 10.17487/RFC4961, July 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5764">[RFC5764]</b></td>
<td class="top">
<a>McGrew, D.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5764">Datagram Transport Layer Security (DTLS) Extension to Establish Keys for the Secure Real-time Transport Protocol (SRTP)</a>", RFC 5764, DOI 10.17487/RFC5764, May 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6241">[RFC6241]</b></td>
<td class="top">
<a>Enns, R.</a>, <a>Bjorklund, M.</a>, <a>Schoenwaelder, J.</a> and <a>A. Bierman</a>, "<a href="https://tools.ietf.org/html/rfc6241">Network Configuration Protocol (NETCONF)</a>", RFC 6241, DOI 10.17487/RFC6241, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6665">[RFC6665]</b></td>
<td class="top">
<a>Roach, A.</a>, "<a href="https://tools.ietf.org/html/rfc6665">SIP-Specific Event Notification</a>", RFC 6665, DOI 10.17487/RFC6665, July 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6750">[RFC6750]</b></td>
<td class="top">
<a>Jones, M.</a> and <a>D. Hardt</a>, "<a href="https://tools.ietf.org/html/rfc6750">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a>", RFC 6750, DOI 10.17487/RFC6750, October 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7033">[RFC7033]</b></td>
<td class="top">
<a>Jones, P.</a>, <a>Salgueiro, G.</a>, <a>Jones, M.</a> and <a>J. Smarr</a>, "<a href="https://tools.ietf.org/html/rfc7033">WebFinger</a>", RFC 7033, DOI 10.17487/RFC7033, September 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7230">[RFC7230]</b></td>
<td class="top">
<a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>", RFC 7230, DOI 10.17487/RFC7230, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7231">[RFC7231]</b></td>
<td class="top">
<a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>", RFC 7231, DOI 10.17487/RFC7231, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7235">[RFC7235]</b></td>
<td class="top">
<a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7235">Hypertext Transfer Protocol (HTTP/1.1): Authentication</a>", RFC 7235, DOI 10.17487/RFC7235, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7565">[RFC7565]</b></td>
<td class="top">
<a>Saint-Andre, P.</a>, "<a href="https://tools.ietf.org/html/rfc7565">The 'acct' URI Scheme</a>", RFC 7565, DOI 10.17487/RFC7565, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7950">[RFC7950]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc7950">The YANG 1.1 Data Modeling Language</a>", RFC 7950, DOI 10.17487/RFC7950, August 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8340">[RFC8340]</b></td>
<td class="top">
<a>Bjorklund, M.</a> and <a>L. Berger</a>, "<a href="https://tools.ietf.org/html/rfc8340">YANG Tree Diagrams</a>", BCP 215, RFC 8340, DOI 10.17487/RFC8340, March 2018.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Kaustubh Inamdar</span> 
	  <span class="n hidden">
		<span class="family-name">Inamdar</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:kinamdar@cisco.com">kinamdar@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Sreekanth Narayanan</span> 
	  <span class="n hidden">
		<span class="family-name">Narayanan</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:sreenara@cisco.com">sreenara@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Cullen Jennings</span> 
	  <span class="n hidden">
		<span class="family-name">Jennings</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:fluffy@iii.ca">fluffy@iii.ca</a></span>

  </address>
</div>

</body>
</html>
